So I'm assuming it fails for large input sizes.

One optimisation I can think of is using dicts to condense ones that have first 3 cols similar and just add the ways
Because the output number won't need to differentiate between:
1   2
3
and
1
3   2
Both are same to it.

And on submission we get all except one case :D let's work on it once done with the rest!
